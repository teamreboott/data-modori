2023-11-13 22:10:48.493 | INFO     | data_juicer.config.config:config_backup:398 - Back up the input config file [/home/jongsky/workspace/reboott/data-juicer-for-reboott/data-juicer/configs/analyser.yaml] into the work_dir [./output]
2023-11-13 22:10:48.496 | INFO     | data_juicer.config.config:display_config:417 - Configuration table: 
╒════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                                                    │
╞════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(configs/analyser.yaml, cwd=/home/jongsky/workspace/reboott/data-juicer-for-reboott/data-juicer)] │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'demo-analyser'                                                                                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ './data/test.json'                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ './output/test.jsonl'                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'content'                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ PosixPath('/home/jongsky/.cache/huggingface/datasets')                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'language_id_score_filter': {'lang': 'en',                                                              │
│                        │                                'min_score': 0.8,                                                          │
│                        │                                'text_key': 'content'}},                                                   │
│                        │  {'perplexity_filter': {'lang': 'en', 'max_ppl': 1500, 'text_key': 'content'}}]                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ './output'                                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20231113221048'                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                                     │
╘════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════╛
2023-11-13 22:10:48.497 | INFO     | data_juicer.core.analyser:__init__:38 - Using cache compression method: [None]
2023-11-13 22:10:48.497 | INFO     | data_juicer.core.analyser:__init__:43 - Setting up data formatter...
2023-11-13 22:10:48.497 | INFO     | data_juicer.core.analyser:__init__:52 - Preparing exporter...
2023-11-13 22:10:48.498 | INFO     | data_juicer.core.analyser:run:73 - Loading dataset from data formatter...
2023-11-13 22:10:49.305 | INFO     | logging:handle:954 - Found cached dataset json (/home/jongsky/.cache/huggingface/datasets/json/default-cddeaebd95fa37c9/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e)
  0%|          | 0/1 [00:00<?, ?it/s]100%|##########| 1/1 [00:00<00:00, 1198.37it/s]
2023-11-13 22:10:49.308 | INFO     | data_juicer.format.formatter:unify_format:173 - Unifying the input dataset formats...
2023-11-13 22:10:49.308 | INFO     | data_juicer.format.formatter:unify_format:188 - There are 6 sample(s) in the original dataset.
2023-11-13 22:10:49.313 | INFO     | logging:handle:954 - Loading cached processed dataset at /home/jongsky/.cache/huggingface/datasets/json/default-cddeaebd95fa37c9/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e/cache-1ff715c3e3bb22e2_*_of_00004.arrow
/home/jongsky/anaconda3/envs/data-juicer/lib/python3.8/site-packages/datasets/table.py:1407: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
2023-11-13 22:10:49.314 | INFO     | data_juicer.format.formatter:unify_format:202 - 6 samples left after filtering empty text.
2023-11-13 22:10:49.315 | INFO     | data_juicer.format.mixture_formatter:load_dataset:95 - sampled 6 from 6 with weight 1.0
2023-11-13 22:10:49.316 | INFO     | data_juicer.format.mixture_formatter:load_dataset:101 - There are 6 in final dataset
2023-11-13 22:10:49.316 | INFO     | data_juicer.core.analyser:run:79 - Preparing process operators...
2023-11-13 22:10:49.317 | INFO     | data_juicer.utils.model_utils:prepare_fasttext_model:87 - Loading fasttext language identification model...
Warning : `load_model` does not return WordVectorModel or SupervisedModel any more, but a `FastText` object which is very similar.
2023-11-13 22:10:49.389 | INFO     | data_juicer.utils.model_utils:prepare_sentencepiece_model:104 - Loading sentencepiece model...
2023-11-13 22:10:49.418 | INFO     | data_juicer.utils.model_utils:prepare_kenlm_model:122 - Loading kenlm language model...
2023-11-13 22:10:49.489 | INFO     | data_juicer.core.analyser:run:84 - Computing the stats of dataset...
2023-11-13 22:10:49.492 | INFO     | logging:handle:954 - Loading cached processed dataset at /home/jongsky/.cache/huggingface/datasets/json/default-cddeaebd95fa37c9/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e/cache-3b7d5d2fe24628bc.arrow
/home/jongsky/anaconda3/envs/data-juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
2023-11-13 22:10:49.499 | INFO     | logging:handle:954 - Loading cached processed dataset at /home/jongsky/.cache/huggingface/datasets/json/default-cddeaebd95fa37c9/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e/cache-bcbd38c276758aad_*_of_00004.arrow
2023-11-13 22:10:49.507 | INFO     | logging:handle:954 - Loading cached processed dataset at /home/jongsky/.cache/huggingface/datasets/json/default-cddeaebd95fa37c9/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e/cache-a411a1042aec307f_*_of_00004.arrow
2023-11-13 22:10:49.509 | INFO     | data_juicer.core.analyser:run:111 - Applying overall analysis on stats...
2023-11-13 22:10:49.514 | INFO     | data_juicer.core.analyser:run:115 - Applying column-wise analysis on stats...
2023-11-13 22:10:50.135 | INFO     | data_juicer.core.analyser:run:124 - Exporting dataset to disk...
Creating json from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating json from Arrow format: 100%|##########| 1/1 [00:00<00:00, 813.16ba/s]
