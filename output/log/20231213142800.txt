2023-12-13 14:28:00.734 | INFO     | data_juicer.config.config:config_backup:456 - Back up the input config file [/home/kyuheon/jy_workspace/reboott_llm_pipeline/data-juicer/./configs/process.yaml] into the work_dir [./output]
2023-12-13 14:28:00.740 | INFO     | data_juicer.config.config:display_config:477 - Configuration table: 
╒════════════════════════╤════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                                             │
╞════════════════════════╪════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(./configs/process.yaml, cwd=/home/kyuheon/jy_workspace/reboott_llm_pipeline/data-juicer)] │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                               │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'demo-process'                                                                                     │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                                          │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ './data/test.json'                                                                                 │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ './output/test.jsonl'                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                                  │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                                  │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'content'                                                                                          │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                                           │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                                    │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                                    │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                                 │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                               │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ PosixPath('/home/kyuheon/.cache/huggingface/datasets')                                             │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                               │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                               │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                                 │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                                 │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'alphanumeric_filter': {'image_key': 'images',                                                   │
│                        │                           'max_ratio': 0.9,                                                        │
│                        │                           'min_ratio': 0.0,                                                        │
│                        │                           'text_key': 'content',                                                   │
│                        │                           'tokenization': False}}]                                                 │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                                             │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ './output'                                                                                         │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20231213142800'                                                                                   │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/home/kyuheon/jy_workspace/reboott_llm_pipeline/data-juicer/data'                                 │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                              │
╘════════════════════════╧════════════════════════════════════════════════════════════════════════════════════════════════════╛
2023-12-13 14:28:00.741 | INFO     | data_juicer.core.executor:__init__:41 - Using cache compression method: [None]
2023-12-13 14:28:00.741 | INFO     | data_juicer.core.executor:__init__:46 - Setting up data formatter...
2023-12-13 14:28:00.742 | INFO     | data_juicer.core.executor:__init__:68 - Preparing exporter...
2023-12-13 14:28:00.742 | INFO     | data_juicer.core.executor:run:99 - Loading dataset from data formatter...
2023-12-13 14:28:01.669 | INFO     | datasets.load:load_dataset:1791 - Downloading and preparing dataset json/default to /home/kyuheon/.cache/huggingface/datasets/json/default-162365534be67af3/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e...
Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]Downloading data files: 100%|##########| 1/1 [00:00<00:00, 1859.18it/s]
Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]Extracting data files: 100%|##########| 1/1 [00:00<00:00, 576.22it/s]
2023-12-13 14:28:01.680 | INFO     | logging:handle:954 - Setting num_proc from 4 back to 1 for the json split to disable multiprocessing as it only contains one shard.
Generating json split: 0 examples [00:00, ? examples/s]                                                       2023-12-13 14:28:01.690 | INFO     | datasets.load:load_dataset:1791 - Dataset json downloaded and prepared to /home/kyuheon/.cache/huggingface/datasets/json/default-162365534be67af3/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e. Subsequent calls will reuse this data.
  0%|          | 0/1 [00:00<?, ?it/s]100%|##########| 1/1 [00:00<00:00, 224.94it/s]
2023-12-13 14:28:01.701 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2023-12-13 14:28:01.702 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 8 sample(s) in the original dataset.
Filter (num_proc=4):   0%|          | 0/8 [00:00<?, ? examples/s]                                                                 /home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1407: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
2023-12-13 14:28:01.899 | INFO     | data_juicer.format.formatter:unify_format:214 - 8 samples left after filtering empty text.
2023-12-13 14:28:01.900 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 8 from 8
2023-12-13 14:28:01.903 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 8 in final dataset
2023-12-13 14:28:01.903 | INFO     | data_juicer.core.executor:run:105 - Preparing process operators...
2023-12-13 14:28:01.904 | INFO     | data_juicer.core.executor:run:112 - Processing data...
Adding new column for stats (num_proc=4):   0%|          | 0/8 [00:00<?, ? examples/s]/home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
/home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
/home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
/home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
                                                                                      alphanumeric_filter_compute_stats (num_proc=4):   0%|          | 0/8 [00:00<?, ? examples/s]/home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
/home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
/home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
/home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
                                                                                            alphanumeric_filter_process (num_proc=4):   0%|          | 0/8 [00:00<?, ? examples/s]/home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
/home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
/home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
/home/kyuheon/anaconda3/envs/juicer/lib/python3.8/site-packages/datasets/table.py:1373: FutureWarning: promote has been superseded by mode='default'.
  return cls._concat_blocks(pa_tables_to_concat_vertically, axis=0)
                                                                                      2023-12-13 14:28:02.449 | INFO     | data_juicer.core.executor:run:188 - Op [alphanumeric_filter] Done in 0.544(s). Left 8 samples.
2023-12-13 14:28:02.449 | INFO     | data_juicer.core.executor:run:192 - All Ops are done in 0.545(s).
2023-12-13 14:28:02.450 | INFO     | data_juicer.core.executor:run:195 - Exporting dataset to disk...
2023-12-13 14:28:02.451 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating json from Arrow format: 100%|##########| 1/1 [00:00<00:00, 111.32ba/s]
2023-12-13 14:28:02.470 | INFO     | data_juicer.core.exporter:_export_impl:137 - Export dataset into a single file...
Creating json from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating json from Arrow format: 100%|##########| 1/1 [00:00<00:00, 403.53ba/s]
